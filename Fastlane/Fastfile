fastlane_version '2.157'
default_platform :ios

# SwiftLint Configuration
LINT_REPORT_OUTPUT = "fastlane/lintResults.html"
SWIFTLINT_PATH = "/opt/homebrew/bin/swiftlint" # M1 Mac için, Intel Mac için "/usr/local/bin/swiftlint"
SWIFTLINT_CONFIG = ".swiftlint.yml"

platform :ios do
    desc 'Builds project and executes unit tests'
    lane :unit_test do |options|
      scan(
        clean: options[:clean],
        skip_package_dependencies_resolution: options[:skip_package_dependencies_resolution]
      )
    end

    desc 'Lints the codebase with SwiftLint'
    def check_code_style
        swiftlint(
            mode: :lint,
            strict: true,
            executable: SWIFTLINT_PATH,
            reporter: "html",
            output_file: LINT_REPORT_OUTPUT,
            config_file: SWIFTLINT_CONFIG
        )
    end

    lane :lint do |options|
        check_code_style
    end
end